<template>
    <div class="setup">
        <backdrop v-if="displayBackdrop">
            <transition name="fade" mode="out-in" appear>
                <verify-code v-if="currentAppStatus === 'setup-verify-code'" @displayWelcome="loadWelcome"/>
                <welcome v-else-if="displayWelcome" @hideWelcome="hideWelcome"/>
                <completed v-else-if="isSetupCompleted"/>
            </transition>
        </backdrop>

        <div class="setup__view">
          <general v-if="setup.setupType === 'general'"/>
          <budget v-else/>
        </div>
    </div>
</template>

<script>
import Backdrop from '@/components/Layout/Backdrop/Backdrop'
import Completed from './Completed'
import VerifyCode from './VerifyCode'
import Welcome from './Welcome'

import General from './General/General'
import Budget from './Budget/Budget'

import { mapGetters } from 'vuex'

export default {
  data () {
    return {
      loading: true,
      displayBackdrop: false,
      displayWelcome: false,
      displayVerificationCode: false,
      isSetupCompleted: false
    }
  },
  computed: {
    ...mapGetters([
      'user',
      'setup',
      'currentAppStatus'
    ])
  },
  mounted () {
    if (this.currentAppStatus === 'setup-verify-code') {
      this.displayBackdrop = true
    } else {
      this.loadWelcome()
    }
  },
  methods: {
    loadVerificationCode () {
      setTimeout(() => {
        this.displayVerificationCode = true
        this.displayBackdrop = true
      }, 1000)
    },
    loadWelcome () {
      setTimeout(() => {
        this.displayBackdrop = true
        this.displayWelcome = true
      }, 1000)
    },
    loadCompleted () {
      setTimeout(() => {
        this.displayBackdrop = true
        this.isSetupCompleted = true
      })
    },
    hideWelcome () {
      this.displayBackdrop = false
      this.displayWelcome = false
      this.loading = false
    }
  },
  components: {
    Backdrop,
    Budget,
    Completed,
    General,
    VerifyCode,
    Welcome
  }
}
</script>

<style lang="scss" >
.setup {
    width: 100%;
    max-width: 120rem;
    position: relative;
    display: flex;
    justify-content: center;
    &__view {
        width: 100%;
        height: 100%;
        position: relative;
        overflow: hidden;
        // background: green;
        &__content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all .5s ease-in;
            &.left {
                transform: translateX(-110%);
            }
            &.right {
                transform: translateX(110%);
            }
            &.center {
                transform: translateX(0);
            }
            &__main {
                height: 16rem;
                width: 100%;
                background: var(--surfaceColor);
                border-radius: .5rem;
                padding: 2rem 4rem;
                position: relative;
                display: flex;
                flex-direction: column;
                &.expand {
                    height: 90%;
                }
                &__title {
                    color: var(--mainColor);
                    // background: red;
                    height: 5rem;
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    // padding-left: 2rem;
                    margin-bottom: 2rem;
                    &__add {
                        background: var(--secondaryColor);
                        height: 2.5rem;
                        width: 2.5rem;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        border-radius: 50%;
                    }
                }
                &__details {
                    font-size: $font-m;
                }
                &__list {
                    list-style: none;
                    margin: 4rem 0;
                    display: grid;
                    grid-template-columns: repeat(auto-fit, 25rem);
                    grid-template-rows: 12rem;
                    grid-auto-rows: 12rem;
                    column-gap: 2rem;
                    row-gap: 2rem;
                    &__item {
                        width: 25rem;
                        height: 12rem;
                        &--add {
                            margin: 1rem 0;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            width: 25rem;
                            height: 12rem;
                            border: 1px dashed var(--textColor--dark);
                            border-radius: 1rem;
                            padding: 1rem;
                        }
                    }
                }
                &__cta {
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    margin: auto;
                    display: flex;
                    justify-content: center;
                    padding: 2rem 0;
                }
            }
            &__nav {
              display: flex;
              justify-content: center;
            }
            &__form {
                width: 80rem;
                background: #e9e7e7;
                padding: 3rem;
                position: relative;
                border-radius: .5rem;
                transform: translateY(-3rem);
                &.active{
                    transform: translateY(0);
                    position: absolute;
                    bottom: 0;
                    top: 0;
                    left: 0;
                    right: 0;
                    margin: auto;
                    height: min-content;
                }
            }
        }
    }
}

</style>
